<main class="app">
  <header class="app__header">
    <h1>Euro-St&uuml;ckelung Rechner</h1>
    <p>
      Berechne die minimale Anzahl an Scheinen und M&uuml;nzen f&uuml;r einen Betrag und vergleiche das Ergebnis mit der
      letzten Ausgabe.
    </p>
  </header>

  <section class="app__controls">
    <form class="app__form" [formGroup]="form" (ngSubmit)="submit()">
      <label class="form-field">
        <span>Betrag in Euro</span>
        <input
          type="text"
          formControlName="amount"
          placeholder="z.&nbsp;B. 234,23"
          [class.form-field__input--invalid]="inputError() !== null"
        />
      </label>

      <div class="form-field form-field--inline">
        <span>Berechnungsmodus</span>
        <label>
          <input
            type="radio"
            name="mode"
            value="frontend"
            [checked]="currentMode() === 'frontend'"
            (change)="changeMode('frontend')"
          />
          Frontend (TypeScript)
        </label>
        <label>
          <input
            type="radio"
            name="mode"
            value="backend"
            [checked]="currentMode() === 'backend'"
            (change)="changeMode('backend')"
          />
          Backend (Spring Boot)
        </label>
      </div>

      <div class="app__form-actions">
        <button type="submit" [disabled]="isProcessing()">Berechnen</button>
        <button type="button" class="secondary" (click)="reset()">Zur&uuml;cksetzen</button>
      </div>
    </form>

    <div class="app__status">
      <p *ngIf="isProcessing()">Berechnung l&auml;uft &hellip;</p>
      <p *ngIf="inputError() as msg" class="status status--error">{{ msg }}</p>
      <p *ngIf="error() as serverError" class="status status--error">{{ serverError }}</p>
    </div>
  </section>

  <section class="app__results">
    <article>
      <h2>Neue St&uuml;ckelung</h2>
      <table>
        <thead>
          <tr>
            <th>Schein/M&uuml;nze</th>
            <th>Anzahl</th>
          </tr>
        </thead>

        <tbody *ngIf="breakdown(); else noBreakdown">
          <tr *ngFor="let item of breakdown()!.items; trackBy: trackByDenomination">
            <td>{{ formatEuro(item.denomination) }}</td>
            <td>{{ item.count }}</td>
          </tr>
        </tbody>
      </table>
    </article>

    <article>
      <h2>Differenz zur vorherigen Ausgabe</h2>
      <table>
        <thead>
          <tr>
            <th>Schein/M&uuml;nze</th>
            <th>Differenz</th>
          </tr>
        </thead>

        <tbody *ngIf="diff().length > 0; else noDiff">
          <tr *ngFor="let item of diff(); trackBy: trackByDenomination">
            <td>{{ formatEuro(item.denomination) }}</td>
            <td [class.positive]="item.delta > 0" [class.negative]="item.delta < 0">
              {{ item.delta > 0 ? '+' : '' }}{{ item.delta }}
            </td>
          </tr>
        </tbody>
      </table>
    </article>
  </section>

  <ng-template #noBreakdown>
    <tbody>
      <tr>
        <td colspan="2">Noch keine Berechnung durchgef&uuml;hrt.</td>
      </tr>
    </tbody>
  </ng-template>

  <ng-template #noDiff>
    <tbody>
      <tr>
        <td colspan="2">Keine Differenzen verf&uuml;gbar.</td>
      </tr>
    </tbody>
  </ng-template>
</main>
